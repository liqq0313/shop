<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link href="__ADMIN__/css/shop.css" type="text/css" rel="stylesheet" />
<link href="__ADMIN__/css/Sellerber.css" type="text/css"  rel="stylesheet" />
<link href="__ADMIN__/css/bkg_ui.css" type="text/css"  rel="stylesheet" />
<link href="__ADMIN__/font/css/font-awesome.min.css"  rel="stylesheet" type="text/css" />
<script src="__ADMIN__/js/jquery-1.9.1.min.js" type="text/javascript" ></script>
<script type="text/javascript" src="__ADMIN__/js/jquery.cookie.js"></script>
<script src="__ADMIN__/js/shopFrame.js" type="text/javascript"></script>
<script src="__ADMIN__/js/Sellerber.js" type="text/javascript"></script>
<script src="__ADMIN__/js/layer/layer.js" type="text/javascript"></script>
<script src="__ADMIN__/js/jquery.dataTables.min.js"></script>
<script src="__ADMIN__/js/jquery.dataTables.bootstrap.js"></script>
<title>商品管理</title>
</head>

<body>
<div class="margin" id="page_style">
<div class="operation clearfix">
<button class="btn button_btn btn-danger" type="button" onclick=""><i class="fa fa-trash-o"></i>&nbsp;删除</button>
<span class="submenu"><a href="javascript:void(0)" name="{:url('admin/goods/add')}" class="btn button_btn bg-deep-blue" title="添加产品"><i class="fa  fa-edit"></i>&nbsp;添加商品</a></span>
</div>
<!-- 搜索 -->
<table class="table table_list table_striped table-bordered margin-sx">
	<tr>
	<th><input type="text" name="" placeholder="输入商品名称"></th>
	<th><select name="category_big">
		</select>
		<select name="category_second">		
		</select>
		<select name="category_last">		
		</select>
	</th>
	<th></th>
	<th><select name="status">
		<option>选择状态</option>
		<option value="1">上架</option>
		<option value="0">下架</option>
	</select></th>
	<th><button class="btn button_btn bg-deep-blue" type="button"><i class="fa fa-search"></i>&nbsp;搜索</button></th>
</tr>
</table>
<!--列表展示-->
<div class="list_Exhibition margin-sx">
 <table class="table table_list table_striped table-bordered" id="sample-table">
  <thead>
  <tr>
  <th width="30"><label><input type="checkbox" class="ace"><span class="lbl"></span></label></th>
   <th width="100">ID</th>
   <th width="100">商品编号</th>
   <th width="100">图片</th>
   <th>商品名称</th>
   <th width="100">分类</th>
   <th width="100">价格</th>
   <th width="100">数量</th>
   <th width="150">添加日期</th>
   <th width="100">状态</th>
   <th width="220">操作</th>
   </tr>   
  </thead>
  <tbody>
   <tr>
   </tr>
  </tbody>
 </table>
</div>
</div>
</body>
</html>
<script type="text/javascript">
//设置框架
/*$("#page_style").frame({
	float : 'left',
	menu_nav:'.operation',
	color_btn:'.skin_select',
});*/


showCategory($("select[name='category_big']") , 0);
$("select[name='category_second']").hide();
$("select[name='category_last']").hide();

function showCategory(parent,pid)
{
	parent.empty();
	parent.hide();
	$.get("{:url('index/category/getChildCate')}",
		{"id":pid},
		function(data){
			var str = '';
			if (data.length>0) {parent.show();
			}
			for(child in data)
			{
				str +="<option value='"+data[child]['category_id']+"'>"+data[child]['name']+"</option>";
			}
			parent.append(str);

			var arr = data[child]['path'].split(',');

			if (arr.length==2) {
				showCategory($("select[name='category_second']") , parent.val());
			}else if(arr.length==3){
				showCategory($("select[name='category_last']") , parent.val());
			}
	});
}

$("select[name='category_big']").change(function(){
	showCategory($("select[name='category_second']") , $(this).val());
});

$("select[name='category_second']").change(function(){
	showCategory($("select[name='category_last']") , $(this).val());
});

var dataSet = new Array;
$.post("{:url('admin/goods/showGoods')}",{"page":1,"num":10},function(data){
	var temp;
	for(var child in data){
		temp = ['<label><input type="checkbox" class="ace"><span class="lbl"></span></label>',data[child]['goods_id'],data[child]['goods_no'],data[child]['name'],'55','234.50','促销化妆品','4567','2016-03-12 10:34:12','<span class="label label-success label-sm">上架</span>',' <a href="javascript:ovid()" onclick="picture_stop(this,"10001")" class="btn bg-green operation_btn">下架</a> <a href="javascript:ovid()" onclick="picture_edit(this,"123")" class="btn bg-deep-blue operation_btn">修改</a> <a href="javascript:ovid()" onclick="picture_del(this,'+10001+')" class="btn btn-danger operation_btn">删除</a> <a href="javascript:ovid()" onclick="picture_img(this,'+232+'))" class="btn bg-deep-blue operation_btn">图片</a>'];


		dataSet.push(temp);
	}

	var oTable1 = $('#sample-table').dataTable( {
		"data": dataSet,
		"searching": false,
		"width":"100%",
		"scrollY": true,
		"lengthChange": false,
		"iDisplayLength":10,
		"paging": true,
		/*"bLengthChange":false,
		"iDisplayLength": 20,
        "bStateSave": true,
		"searching": false,
        "aoColumnDefs": [{"orderable":false,"aTargets":[0,8,9]}]*/
	   });

		$('table th input:checkbox').on('click' , function(){
			var that = this;
			$(this).closest('table').find('tr > td:first-child input:checkbox')
			.each(function(){
				this.checked = that.checked;
				$(this).closest('tr').toggleClass('selected');
			});
				
		});
});


	/*var dataSet=[
    ['<label><input type="checkbox" class="ace"><span class="lbl"></span></label>','1233', '贝德玛（Bioderma）温和卸妆水净妍/舒妍洁肤液卸妆水','55','234.50','促销化妆品','4567','2016-03-12 10:34:12','<span class="label label-success label-sm">上架</span>',' <a href="javascript:ovid()" onclick="picture_stop(this,"10001")" class="btn bg-green operation_btn">下架</a> <a href="javascript:ovid()" onclick="picture_edit(this,"123")" class="btn bg-deep-blue operation_btn">修改</a> <a href="javascript:ovid()" onclick="picture_del(this,'+10001+')" class="btn btn-danger operation_btn">删除</a> <a href="javascript:ovid()" onclick="picture_img(this,'+232+'))" class="btn bg-deep-blue operation_btn">图片</a>']
    ];*/


	/*jQuery(function($) {
				var oTable1 = $('#sample-table').dataTable( {
				"data": dataSet,
				"width":"100%",	
				"bLengthChange":false,
				"iDisplayLength": 20,
				"aaSorting": [[ 1, "desc" ]],//默认第几个排序
		        "bStateSave": true,//状态保存
				"searching": false,
		        "aoColumnDefs": [{"orderable":false,"aTargets":[0,8,9]}]
			   });

				$('table th input:checkbox').on('click' , function(){
					var that = this;
					$(this).closest('table').find('tr > td:first-child input:checkbox')
					.each(function(){
						this.checked = that.checked;
						$(this).closest('tr').toggleClass('selected');
					});
						
				});

	});*/


 /*
$(document).ready(function(){
    var spotMax = 8;
  if($('#add_Carousel_figure .table tbody tr').size() >= spotMax) {$(obj).hide();}
  $("#add_Upload").on('click',function(){ 
       var cid =$('.images_Upload').each(function(i){ $(this).attr('id',"Uimages_Upload_"+i)});
       addSpot(this, spotMax, cid);
  });
});
function addSpot(obj, sm ,sid) {
	  $("#Upload").append("<div class='images_Upload clearfix margin-bottom' id='"+sid+"'>"+
	  "<span class='Upload_img'><input name='' type='file' /></span>"+
	  "<a href='javascript:ovid()' class='operating delete_Upload'><i class='fa fa-remove'></i></a>"+
	  "<a href='javascript:ovid()' class='operating' onclick='preview_img(this.id)'><i class='fa  fa-image'></i></a>"+
	  "</div>&nbsp;")  
	.find(".delete_Upload").click(function(){
		if($('div.images_Upload').size()==1){
			layer.msg('请至少保留一张图片!',{icon:0,time:1000});			
			}
			else{
				 $(this).parent().remove();
                 $('#add_Upload').show();
				} 				
				
  });
  if($('.delete_Upload').size() >= sm) {$(obj).hide();layer.msg('当前为最大图片添加量!',{icon:0,time:1000});}}
			  
			jQuery(function($) {
				var oTable1 = $('#sample-table').dataTable( {
				"data": dataSet,
				"width":"100%",	
				"bLengthChange":false,
				"iDisplayLength": 20,
				"aaSorting": [[ 1, "desc" ]],//默认第几个排序
		        "bStateSave": true,//状态保存
				"searching": false,
		        "aoColumnDefs": [{"orderable":false,"aTargets":[0,8,9]}]
			   });
								
				$('table th input:checkbox').on('click' , function(){
					var that = this;
					$(this).closest('table').find('tr > td:first-child input:checkbox')
					.each(function(){
						this.checked = that.checked;
						$(this).closest('tr').toggleClass('selected');
					});
						
				});
			});

/***********图片查看**********/
/*
function picture_img(ojb,id){
	 layer.open({
        type: 1,
        title: '产品轮播图',
		maxmin: true, 
		shadeClose:false, //点击遮罩关闭层
        area : ['800px' , '400px'],
        content:$('#add_Carousel_figure'),
		btn:['提交','取消'],
	 });
	}
	/*产品-删除*/
	/*
function picture_del(obj,id){
	layer.confirm('确认要删除吗？',{icon:0,},function(index){
		$(obj).parents("tr").remove();
		layer.msg('已删除!',{icon:1,time:1000});
	});
}
/*商品-停用*/
/*
function picture_stop(obj,id){
	layer.confirm('确认要下架吗？',function(index){
		$(obj).parents("tr").find(".td-manage").prepend('<a style="text-decoration:none" class="btn bg-gray operation_btn" onClick="picture_start(this,id)" href="javascript:;" title="上架">上架</a>');
		$(obj).parents("tr").find(".td-status").html('<span class="label label-defaunt radius">已停用</span>');
		$(obj).remove();
		layer.msg('已下架!',{icon: 5,time:1000});
	});
}

/*商品-启用*/
/*
function picture_start(obj,id){
	layer.confirm('确认要上架吗？',function(index){
		$(obj).parents("tr").find(".td-manage").prepend('<a style="text-decoration:none" class="btn bg-green operation_btn" onClick="picture_stop(this,id)" href="javascript:;" title="下架">下架</a>');
		$(obj).parents("tr").find(".radius").html('<span class="label label-success radius">已启用</span>');
		$(obj).remove();
		layer.msg('已上架!',{icon: 6,time:1000});
	});
}
*/
/*滚动事件*/

/*$("#page_style").niceScroll({  
	cursorcolor:"#888888",  
	cursoropacitymax:1,  
	touchbehavior:false,  
	cursorwidth:"5px",  
	cursorborder:"0",  
	cursorborderradius:"5px"  
});

 $(document).ready(function(){
	var ReturnWindow=$('#contents', parent.document); 
	var width = ReturnWindow.css("width");
	 $("#sample-table").css({"width":width-20+"px"});
	  $('#sample-table').location.replace(location.href);
	 });*/
	 
</script>
